{"ast":null,"code":"var _jsxFileName = \"D:\\\\C_Fashion_Shopping\\\\Frontend\\\\src\\\\pages\\\\UserPage\\\\CartPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport toast from \"react-hot-toast\";\nimport { jwtDecode } from \"jwt-decode\";\nimport Navbar from \"../../Layouts/Navbar\";\nimport Footer from \"../../Layouts/Footer\";\nimport ProductSale from \"../../Product/ProductSale\";\nimport { FaCartPlus } from \"react-icons/fa\";\nimport Loading from \"../../components/common/Loading\";\nimport { useNavigate } from \"react-router-dom\";\nimport CartItem from \"src/Cart/CartItem\";\nimport ShippingAddress from \"src/Cart/ShippingAddress\";\nimport DiscountAndNote from \"src/Cart/DiscountAndNote\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartPage = () => {\n  _s();\n  const [cartItems, setCartItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const [province, setProvince] = useState(\"\");\n  const [district, setDistrict] = useState(\"\");\n  const [ward, setWard] = useState(\"\");\n  const [provinces, setProvinces] = useState([]);\n  const [districts, setDistricts] = useState([]);\n  const [wards, setWards] = useState([]);\n  const [coupon, setCoupon] = useState(\"\");\n  const [invoice, setInvoice] = useState(false);\n  const [note, setNote] = useState(\"\");\n  const [shippingFee, setShippingFee] = useState(null);\n  const [productList, setProductList] = useState([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [estimatedDelivery, setEstimatedDelivery] = useState(\"\"); // D√πng ƒë·ªÉ l∆∞u th·ªùi gian giao h√†ng\n  const [selectedItems, setSelectedItems] = useState([]);\n  const [isCalculatingFee, setIsCalculatingFee] = useState(false);\n  const navigate = useNavigate();\n  const getAccountIdFromToken = () => {\n    const token = localStorage.getItem(\"token\");\n    if (!token) return null;\n    const decoded = jwtDecode(token);\n    return parseInt(decoded.accountId);\n  };\n  const accountId = getAccountIdFromToken();\n  useEffect(() => {\n    const fetchCartItems = async () => {\n      try {\n        const response = await axios.get(`/api/cart/${accountId}/views`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        setCartItems(response.data);\n      } catch (error) {\n        var _error$response, _error$response$data;\n        toast.error(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || \"L·ªói khi t·∫£i gi·ªè h√†ng.\");\n      } finally {\n        setLoading(false);\n      }\n    };\n    if (accountId) fetchCartItems();\n  }, [accountId]);\n  const fetchCartItems = async () => {\n    try {\n      const response = await axios.get(`/api/cart/${accountId}/views`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      setCartItems(response.data);\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      toast.error(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || \"L·ªói khi t·∫£i gi·ªè h√†ng.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    axios.get(\"/api/views/suggest\").then(response => {\n      setProductList(response.data);\n    }).catch(error => {\n      var _error$response3, _error$response3$data;\n      toast.error(((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || \"L·ªói khi t·∫£i s·∫£n ph·∫©m g·ª£i √Ω.\");\n    });\n  }, []);\n\n  // ‚úÖ T·∫£i t·ªânh khi m·ªü trang\n  useEffect(() => {\n    const fetchProvinces = async () => {\n      try {\n        const response = await axios.get(\"/api/locations/provinces\");\n        if (Array.isArray(response.data)) {\n          setProvinces(response.data);\n        } else if (response.data.data && Array.isArray(response.data.data)) {\n          setProvinces(response.data.data);\n        } else {\n          toast.error(\"D·ªØ li·ªáu t·ªânh th√†nh kh√¥ng h·ª£p l·ªá\");\n        }\n      } catch (error) {\n        var _error$response4, _error$response4$data;\n        toast.error(((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.message) || \"Kh√¥ng th·ªÉ t·∫£i danh s√°ch t·ªânh/th√†nh.\");\n      }\n    };\n    fetchProvinces();\n  }, []);\n  const handleProvinceChange = async e => {\n    const selectedProvince = e.target.value;\n    setProvince(selectedProvince);\n    setDistrict(\"\");\n    setDistricts([]);\n    setWard(\"\");\n    setWards([]);\n    if (!selectedProvince) return;\n    try {\n      var _response$data$data, _response$data;\n      const response = await axios.get(\"/api/locations/districts\", {\n        params: {\n          provinceId: selectedProvince\n        }\n      });\n      const data = (_response$data$data = (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.data) !== null && _response$data$data !== void 0 ? _response$data$data : response.data;\n      if (Array.isArray(data)) {\n        setDistricts(data);\n      } else {\n        toast.error(\"D·ªØ li·ªáu qu·∫≠n/huy·ªán kh√¥ng h·ª£p l·ªá\");\n        setDistricts([]);\n      }\n    } catch (error) {\n      var _error$response5, _error$response5$data;\n      toast.error(((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.message) || \"L·ªói khi t·∫£i danh s√°ch qu·∫≠n/huy·ªán\");\n    }\n  };\n  const handleDistrictChange = async e => {\n    const selectedDistrict = e.target.value;\n    setDistrict(selectedDistrict);\n    setWard(\"\");\n    setWards([]);\n    if (!selectedDistrict) return;\n    try {\n      var _response$data$data2, _response$data2;\n      const response = await axios.get(\"/api/locations/wards\", {\n        params: {\n          districtId: selectedDistrict\n        }\n      });\n      const data = (_response$data$data2 = (_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.data) !== null && _response$data$data2 !== void 0 ? _response$data$data2 : response.data;\n      if (Array.isArray(data)) {\n        setWards(data);\n      } else {\n        toast.error(\"D·ªØ li·ªáu ph∆∞·ªùng/x√£ kh√¥ng h·ª£p l·ªá\");\n        setWards([]);\n      }\n    } catch (error) {\n      var _error$response6, _error$response6$data;\n      toast.error(((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.message) || \"L·ªói khi t·∫£i danh s√°ch ph∆∞·ªùng/x√£\");\n    }\n  };\n  const handleUpdateQuantity = async (variantId, amount) => {\n    const currentItem = cartItems.find(item => item.variantId === variantId);\n    if (!currentItem) return;\n    const newQuantity = currentItem.quantity + amount;\n    if (newQuantity < 1) return;\n    try {\n      await axios.post(\"/api/cart/update\", {\n        accountId,\n        variantId,\n        quantity: newQuantity\n      }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      setCartItems(prev => prev.map(item => item.variantId === variantId ? {\n        ...item,\n        quantity: newQuantity,\n        totalPrice: item.price * newQuantity\n      } : item));\n      handleCalculateShippingFee();\n    } catch (error) {\n      var _error$response7, _error$response7$data;\n      toast.error(((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : (_error$response7$data = _error$response7.data) === null || _error$response7$data === void 0 ? void 0 : _error$response7$data.message) || \"L·ªói khi c·∫≠p nh·∫≠t gi·ªè h√†ng.\");\n    }\n  };\n\n  // üìå Gi·ªØ nguy√™n xo√° item\n  const handleRemoveItem = async variantId => {\n    try {\n      await axios.delete(\"/api/cart/remove\", {\n        params: {\n          accountId,\n          variantId\n        },\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n        }\n      });\n      setCartItems(prev => prev.filter(item => item.variantId !== variantId));\n      toast.success(\"ƒê√£ x√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè h√†ng!\");\n    } catch (error) {\n      var _error$response8, _error$response8$data;\n      setError(\"L·ªói khi x√≥a s·∫£n ph·∫©m.\");\n      toast.error(((_error$response8 = error.response) === null || _error$response8 === void 0 ? void 0 : (_error$response8$data = _error$response8.data) === null || _error$response8$data === void 0 ? void 0 : _error$response8$data.message) || \"L·ªói khi x√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè h√†ng.\");\n    }\n  };\n\n  // üìå Gi·ªØ nguy√™n c·∫≠p nh·∫≠t bi·∫øn th·ªÉ\n  const handleUpdateVariant = (variantId, newVariant) => {\n    console.log(\"User selected new variant\", variantId, newVariant);\n  };\n  const defaultWeights = {\n    'tshirt': 200,\n    'jeans': 700,\n    'jacket': 600,\n    'dress': 350,\n    'accessory': 100\n  };\n  function getWeight(item) {\n    var _ref, _item$weightPerUnit;\n    return (_ref = (_item$weightPerUnit = item.weightPerUnit) !== null && _item$weightPerUnit !== void 0 ? _item$weightPerUnit : item.category ? defaultWeights[item.category] : undefined) !== null && _ref !== void 0 ? _ref : 200; // fallback chung\n  }\n  const handleCalculateShippingFee = async () => {\n    const selectedCartItems = cartItems.filter(item => selectedItems.includes(item.variantId));\n    if (selectedCartItems.length === 0 || !province || !district || !ward) {\n      setShippingFee(null);\n      return;\n    }\n    try {\n      var _feeResponse$data$dat, _feeResponse$data, _feeResponse$data$dat2, _timeResponse$data$da, _timeResponse$data, _timeResponse$data$da2;\n      setIsCalculatingFee(true);\n      const totalWeight = cartItems.filter(item => selectedItems.includes(item.variantId)).reduce((sum, item) => {\n        const weight = getWeight(item); // t·ª´ h√†m b√™n tr√™n\n        return sum + item.quantity * weight;\n      }, 0);\n      const totalWeightKg = (totalWeight / 1000).toFixed(2); // Tr·ªçng l∆∞·ª£ng m·ªói s·∫£n ph·∫©m (1500 l√† gi√° tr·ªã m·∫∑c ƒë·ªãnh n·∫øu kh√¥ng c√≥)\n\n      // G·ªçi API t√≠nh ph√≠ v·∫≠n chuy·ªÉn v·ªõi tr·ªçng l∆∞·ª£ng ƒë√£ t√≠nh\n      const feeResponse = await axios.post(\"/api/locations/calculate-fee\", {\n        fromProvince: 217,\n        fromDistrict: 1566,\n        fromWard: 510103,\n        toProvince: parseInt(province),\n        toDistrict: parseInt(district),\n        toWard: parseInt(ward),\n        weight: totalWeight // Tr·ªçng l∆∞·ª£ng t·ªïng c·ªông\n      });\n      if (feeResponse.status !== 200) {\n        toast.error(\"L·ªói khi t√≠nh ph√≠ v·∫≠n chuy·ªÉn.\");\n        setShippingFee(null);\n        return;\n      }\n      const fee = (_feeResponse$data$dat = (_feeResponse$data = feeResponse.data) === null || _feeResponse$data === void 0 ? void 0 : (_feeResponse$data$dat2 = _feeResponse$data.data) === null || _feeResponse$data$dat2 === void 0 ? void 0 : _feeResponse$data$dat2.total) !== null && _feeResponse$data$dat !== void 0 ? _feeResponse$data$dat : 0;\n      setShippingFee(fee);\n\n      // G·ªçi API ∆∞·ªõc t√≠nh th·ªùi gian giao h√†ng\n      const timeResponse = await axios.post(\"/api/locations/estimate-delivery-time\", {\n        fromProvince: 217,\n        fromDistrict: 1566,\n        fromWard: 510103,\n        toProvince: parseInt(province),\n        toDistrict: parseInt(district),\n        toWard: parseInt(ward),\n        serviceId: 2 // N·∫øu c√≥ serviceId ho·∫∑c th√™m tham s·ªë kh√°c c·∫ßn thi·∫øt\n      });\n      if (timeResponse.status !== 200) {\n        toast.error(\"L·ªói khi ∆∞·ªõc t√≠nh th·ªùi gian giao h√†ng.\");\n        return;\n      }\n      const estimatedDelivery = (_timeResponse$data$da = (_timeResponse$data = timeResponse.data) === null || _timeResponse$data === void 0 ? void 0 : (_timeResponse$data$da2 = _timeResponse$data.data) === null || _timeResponse$data$da2 === void 0 ? void 0 : _timeResponse$data$da2.estimatedDelivery) !== null && _timeResponse$data$da !== void 0 ? _timeResponse$data$da : \"Kh√¥ng c√≥ d·ªØ li·ªáu\";\n      setEstimatedDelivery(estimatedDelivery); // L∆∞u th·ªùi gian giao h√†ng\n    } catch (error) {\n      var _error$response9, _error$response9$data;\n      toast.error(((_error$response9 = error.response) === null || _error$response9 === void 0 ? void 0 : (_error$response9$data = _error$response9.data) === null || _error$response9$data === void 0 ? void 0 : _error$response9$data.message) || \"Kh√¥ng th·ªÉ t√≠nh ph√≠ v·∫≠n chuy·ªÉn ho·∫∑c th·ªùi gian giao h√†ng.\");\n      setShippingFee(null);\n    } finally {\n      setIsCalculatingFee(false);\n    }\n  };\n  useEffect(() => {\n    if (province && district && ward) {\n      handleCalculateShippingFee();\n    }\n  }, [province, district, ward]);\n  const nextProduct = () => {\n    setCurrentIndex(prev => (prev + 1) % productList.length);\n  };\n  const prevProduct = () => {\n    setCurrentIndex(prev => (prev - 1 + productList.length) % productList.length);\n  };\n  const handleToggleSelectItem = variantId => {\n    setSelectedItems(prev => {\n      const updatedItems = prev.includes(variantId) ? prev.filter(id => id !== variantId) : [...prev, variantId];\n      handleCalculateShippingFee();\n      return updatedItems;\n    });\n  };\n  const handleToggleSelectAll = () => {\n    if (selectedItems.length === cartItems.length) {\n      setSelectedItems([]);\n      handleCalculateShippingFee();\n    } else {\n      setSelectedItems(cartItems.map(item => item.variantId));\n      handleCalculateShippingFee();\n    }\n  };\n  const handleProceedToCheckout = () => {\n    if (selectedItems.length === 0) {\n      toast.error(\"Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt s·∫£n ph·∫©m.\");\n      return;\n    }\n    if (!shippingFee && !isCalculatingFee) {\n      toast.error(\"Vui l√≤ng ƒë·ª£i t√≠nh ph√≠ v·∫≠n chuy·ªÉn.\");\n      return;\n    }\n    const selectedCartItems = cartItems.filter(item => selectedItems.includes(item.variantId));\n    const checkoutData = {\n      items: selectedCartItems,\n      address: {\n        province: province || \"\",\n        district: district || \"\",\n        ward: ward || \"\"\n      },\n      pricing: {\n        subtotal,\n        discount,\n        shippingFee,\n        total,\n        note,\n        coupon,\n        invoice,\n        estimatedDelivery\n      }\n    };\n    navigate(\"/checkout\", {\n      state: checkoutData\n    });\n  };\n  const subtotal = cartItems.filter(item => selectedItems.includes(item.variantId)) // L·ªçc ch·ªâ c√°c s·∫£n ph·∫©m ƒë√£ ch·ªçn\n  .reduce((sum, item) => sum + item.totalPrice, 0); // T√≠nh t·ªïng gi√° tr·ªã c√°c s·∫£n ph·∫©m ƒë√£ ch·ªçn\n\n  const discount = 0;\n  const total = subtotal - discount + (shippingFee || 0); // T√≠nh t·ªïng sau khi √°p d·ª•ng ph√≠ v·∫≠n chuy·ªÉn\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pt-20 flex flex-col lg:flex-row min-h-screen bg-gray-100 p-4 lg:p-6 gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full lg:w-3/5 bg-white p-4 lg:p-6 rounded-lg shadow-md\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"pt-12 text-2xl font-bold flex items-center gap-3\",\n          children: [\"Gi\\u1ECF h\\xE0ng\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: selectedItems.length === cartItems.length,\n            onChange: handleToggleSelectAll,\n            className: \"ml-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 424,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm font-medium\",\n            children: \"Ch\\u1ECDn t\\u1EA5t c\\u1EA3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 430,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 11\n        }, this), loading ? /*#__PURE__*/_jsxDEV(Loading, {\n          text: \"\\u0110ang t\\u1EA3i gi\\u1ECF h\\xE0ng...\",\n          color: \"yellow-500\",\n          size: \"6xl\",\n          icon: /*#__PURE__*/_jsxDEV(FaCartPlus, {\n            className: \"text-yellow-500 text-6xl animate-pulse\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 21\n          }, this) // Icon ƒë·∫°i di·ªán ng∆∞·ªùi d√πng\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 13\n        }, this) : error ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-center text-red-500\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 13\n        }, this) : cartItems.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-center text-gray-500\",\n          children: \"Gi\\u1ECF h\\xE0ng c\\u1EE7a b\\u1EA1n \\u0111ang tr\\u1ED1ng.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 13\n        }, this) : cartItems.map(item => /*#__PURE__*/_jsxDEV(CartItem, {\n          ...item,\n          selected: selectedItems.includes(item.variantId),\n          toggleSelectItem: handleToggleSelectItem,\n          updateQuantity: handleUpdateQuantity,\n          removeItem: handleRemoveItem,\n          updateVariant: handleUpdateVariant\n        }, item.variantId, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full lg:w-2/5 bg-white p-4 lg:p-6 rounded-lg shadow-md\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pt-12\",\n          children: productList.length > 0 && /*#__PURE__*/_jsxDEV(ProductSale, {\n            product: productList[currentIndex],\n            onNext: nextProduct,\n            onPrev: prevProduct,\n            onCartUpdated: fetchCartItems\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 462,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl lg:text-2xl font-bold mb-4 mt-6\",\n          children: \"Th\\xF4ng tin \\u0111\\u01A1n h\\xE0ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2 text-sm lg:text-base\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"T\\u1EA1m t\\xEDnh:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [subtotal.toLocaleString(), \" vn\\u20AB\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 475,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Gi\\u1EA3m gi\\xE1:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 478,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [discount.toLocaleString(), \" vn\\u20AB\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Ph\\xED v\\u1EADn chuy\\u1EC3n:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 482,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: shippingFee !== null ? `${shippingFee.toLocaleString()} vn‚Ç´` : \"ƒêang t√≠nh...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 483,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 481,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between font-bold text-lg text-red-500\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"T\\u1ED5ng c\\u1ED9ng:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [total.toLocaleString(), \" vn\\u20AB\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ShippingAddress, {\n          provinces: provinces,\n          districts: districts,\n          wards: wards,\n          province: province,\n          district: district,\n          ward: ward,\n          handleProvinceChange: handleProvinceChange,\n          handleDistrictChange: handleDistrictChange,\n          setWard: setWard,\n          estimatedDelivery: estimatedDelivery\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(DiscountAndNote, {\n          coupon: coupon,\n          setCoupon: setCoupon,\n          invoice: invoice,\n          setInvoice: setInvoice,\n          note: note,\n          setNote: setNote\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleProceedToCheckout,\n          disabled: selectedItems.length === 0 || shippingFee === null || isCalculatingFee,\n          className: `w-full text-white px-6 py-2 rounded-lg text-lg ${selectedItems.length === 0 || shippingFee === null || isCalculatingFee ? \"bg-gray-400 cursor-not-allowed\" : \"bg-blue-600 hover:bg-blue-700\"}`,\n          children: \"Thanh to\\xE1n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 526,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 417,\n    columnNumber: 5\n  }, this);\n};\n_s(CartPage, \"rslwsz6rXB440UtNS5ubTZVMONM=\", false, function () {\n  return [useNavigate];\n});\n_c = CartPage;\nexport default CartPage;\nvar _c;\n$RefreshReg$(_c, \"CartPage\");","map":{"version":3,"names":["React","useState","useEffect","axios","toast","jwtDecode","Navbar","Footer","ProductSale","FaCartPlus","Loading","useNavigate","CartItem","ShippingAddress","DiscountAndNote","jsxDEV","_jsxDEV","CartPage","_s","cartItems","setCartItems","loading","setLoading","error","setError","province","setProvince","district","setDistrict","ward","setWard","provinces","setProvinces","districts","setDistricts","wards","setWards","coupon","setCoupon","invoice","setInvoice","note","setNote","shippingFee","setShippingFee","productList","setProductList","currentIndex","setCurrentIndex","estimatedDelivery","setEstimatedDelivery","selectedItems","setSelectedItems","isCalculatingFee","setIsCalculatingFee","navigate","getAccountIdFromToken","token","localStorage","getItem","decoded","parseInt","accountId","fetchCartItems","response","get","headers","Authorization","data","_error$response","_error$response$data","message","_error$response2","_error$response2$data","then","catch","_error$response3","_error$response3$data","fetchProvinces","Array","isArray","_error$response4","_error$response4$data","handleProvinceChange","e","selectedProvince","target","value","_response$data$data","_response$data","params","provinceId","_error$response5","_error$response5$data","handleDistrictChange","selectedDistrict","_response$data$data2","_response$data2","districtId","_error$response6","_error$response6$data","handleUpdateQuantity","variantId","amount","currentItem","find","item","newQuantity","quantity","post","prev","map","totalPrice","price","handleCalculateShippingFee","_error$response7","_error$response7$data","handleRemoveItem","delete","filter","success","_error$response8","_error$response8$data","handleUpdateVariant","newVariant","console","log","defaultWeights","getWeight","_ref","_item$weightPerUnit","weightPerUnit","category","undefined","selectedCartItems","includes","length","_feeResponse$data$dat","_feeResponse$data","_feeResponse$data$dat2","_timeResponse$data$da","_timeResponse$data","_timeResponse$data$da2","totalWeight","reduce","sum","weight","totalWeightKg","toFixed","feeResponse","fromProvince","fromDistrict","fromWard","toProvince","toDistrict","toWard","status","fee","total","timeResponse","serviceId","_error$response9","_error$response9$data","nextProduct","prevProduct","handleToggleSelectItem","updatedItems","id","handleToggleSelectAll","handleProceedToCheckout","checkoutData","items","address","pricing","subtotal","discount","state","children","fileName","_jsxFileName","lineNumber","columnNumber","className","type","checked","onChange","text","color","size","icon","selected","toggleSelectItem","updateQuantity","removeItem","updateVariant","product","onNext","onPrev","onCartUpdated","toLocaleString","onClick","disabled","_c","$RefreshReg$"],"sources":["D:/C_Fashion_Shopping/Frontend/src/pages/UserPage/CartPage.tsx"],"sourcesContent":["import React, { useState, useEffect,} from \"react\";\r\nimport axios from \"axios\";\r\nimport toast from \"react-hot-toast\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport Navbar from \"../../Layouts/Navbar\";\r\nimport Footer from \"../../Layouts/Footer\";\r\nimport ProductSale from \"../../Product/ProductSale\";\r\nimport { FaCartPlus } from \"react-icons/fa\";\r\nimport Loading from \"../../components/common/Loading\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport CartItem from \"src/Cart/CartItem\";\r\nimport ShippingAddress from \"src/Cart/ShippingAddress\";\r\nimport DiscountAndNote from \"src/Cart/DiscountAndNote\";\r\n\r\ninterface CartItemType {\r\n  variantId: number;\r\n  productName: string;\r\n  variantDetails: string;\r\n  quantity: number;\r\n  price: number;\r\n  totalPrice: number;\r\n  productImage: string;\r\n  availableColors: string[];\r\n  availableSizes: string[];\r\n  availableMaterials: string[];\r\n  selected: boolean;\r\n  toggleSelectItem: (variantId: number) => void;\r\n  weightPerUnit?: number; // Optional property for weight per unit\r\n}\r\n\r\ninterface Variant {\r\n  variantId: number;\r\n  colorName: string;\r\n  colorCode: string;\r\n  materialName: string;\r\n  sizeName: string;\r\n  stock: number;\r\n  price: number;\r\n}\r\n\r\ninterface Product {\r\n  productId: number;\r\n  productName: string;\r\n  price: number | null;\r\n  image: string;\r\n  imageTypes: string[];\r\n  colorCodes: string[];\r\n  sizeNames: string[];\r\n  materialNames: string[];\r\n  variants: Variant[];\r\n}\r\n\r\ninterface DecodedToken {\r\n  accountId: string;\r\n  exp: number;\r\n  iat: number;\r\n  email: string;\r\n  roles: { authority: string }[];\r\n}\r\n\r\nconst CartPage: React.FC = () => {\r\n  const [cartItems, setCartItems] = useState<CartItemType[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [province, setProvince] = useState(\"\");\r\n  const [district, setDistrict] = useState(\"\");\r\n  const [ward, setWard] = useState(\"\");\r\n  const [provinces, setProvinces] = useState<any[]>([]);\r\n  const [districts, setDistricts] = useState<any[]>([]);\r\n  const [wards, setWards] = useState<any[]>([]);\r\n  const [coupon, setCoupon] = useState(\"\");\r\n  const [invoice, setInvoice] = useState(false);\r\n  const [note, setNote] = useState(\"\");\r\n  const [shippingFee, setShippingFee] = useState<number | null>(null);\r\n  const [productList, setProductList] = useState<Product[]>([]);\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [estimatedDelivery, setEstimatedDelivery] = useState<string>(\"\"); // D√πng ƒë·ªÉ l∆∞u th·ªùi gian giao h√†ng\r\n  const [selectedItems, setSelectedItems] = useState<number[]>([]);\r\n  const [isCalculatingFee, setIsCalculatingFee] = useState(false);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const getAccountIdFromToken = () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) return null;\r\n    const decoded: DecodedToken = jwtDecode(token);\r\n    return parseInt(decoded.accountId);\r\n  };\r\n  const accountId = getAccountIdFromToken();\r\n\r\n  useEffect(() => {\r\n    const fetchCartItems = async () => {\r\n      try {\r\n        const response = await axios.get(`/api/cart/${accountId}/views`, {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n          },\r\n        });\r\n        setCartItems(response.data);\r\n      } catch (error: any) {\r\n        toast.error(error.response?.data?.message || \"L·ªói khi t·∫£i gi·ªè h√†ng.\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (accountId) fetchCartItems();\r\n  }, [accountId]);\r\n\r\n  const fetchCartItems = async () => {\r\n    try {\r\n      const response = await axios.get(`/api/cart/${accountId}/views`, {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n        },\r\n      });\r\n      setCartItems(response.data);\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || \"L·ªói khi t·∫£i gi·ªè h√†ng.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(\"/api/views/suggest\")\r\n      .then((response) => {\r\n        setProductList(response.data);\r\n      })\r\n      .catch((error: any) => {\r\n        toast.error(error.response?.data?.message || \"L·ªói khi t·∫£i s·∫£n ph·∫©m g·ª£i √Ω.\");\r\n      });\r\n  }, []);\r\n\r\n  // ‚úÖ T·∫£i t·ªânh khi m·ªü trang\r\n  useEffect(() => {\r\n    const fetchProvinces = async () => {\r\n      try {\r\n        const response = await axios.get(\"/api/locations/provinces\");\r\n        if (Array.isArray(response.data)) {\r\n          setProvinces(response.data);\r\n        } else if (response.data.data && Array.isArray(response.data.data)) {\r\n          setProvinces(response.data.data);\r\n        } else {\r\n          toast.error(\"D·ªØ li·ªáu t·ªânh th√†nh kh√¥ng h·ª£p l·ªá\");\r\n        }\r\n      } catch (error: any) {\r\n        toast.error(error.response?.data?.message || \"Kh√¥ng th·ªÉ t·∫£i danh s√°ch t·ªânh/th√†nh.\");\r\n      }\r\n    };\r\n    fetchProvinces();\r\n  }, []);\r\n\r\n  const handleProvinceChange = async (e: React.ChangeEvent<HTMLSelectElement>) => {\r\n    const selectedProvince = e.target.value;\r\n    setProvince(selectedProvince);\r\n    setDistrict(\"\");\r\n    setDistricts([]);\r\n    setWard(\"\");\r\n    setWards([]);\r\n\r\n    if (!selectedProvince) return;\r\n\r\n    try {\r\n      const response = await axios.get(\"/api/locations/districts\", {\r\n        params: { provinceId: selectedProvince },\r\n      });\r\n\r\n      const data = response.data?.data ?? response.data;\r\n\r\n      if (Array.isArray(data)) {\r\n        setDistricts(data);\r\n      } else {\r\n        toast.error(\"D·ªØ li·ªáu qu·∫≠n/huy·ªán kh√¥ng h·ª£p l·ªá\");\r\n        setDistricts([]);\r\n      }\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || \"L·ªói khi t·∫£i danh s√°ch qu·∫≠n/huy·ªán\");\r\n    }\r\n  };\r\n\r\n  const handleDistrictChange = async (e: React.ChangeEvent<HTMLSelectElement>) => {\r\n    const selectedDistrict = e.target.value;\r\n    setDistrict(selectedDistrict);\r\n    setWard(\"\");\r\n    setWards([]);\r\n\r\n    if (!selectedDistrict) return;\r\n\r\n    try {\r\n      const response = await axios.get(\"/api/locations/wards\", {\r\n        params: { districtId: selectedDistrict },\r\n      });\r\n\r\n      const data = response.data?.data ?? response.data;\r\n\r\n      if (Array.isArray(data)) {\r\n        setWards(data);\r\n      } else {\r\n        toast.error(\"D·ªØ li·ªáu ph∆∞·ªùng/x√£ kh√¥ng h·ª£p l·ªá\");\r\n        setWards([]);\r\n      }\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || \"L·ªói khi t·∫£i danh s√°ch ph∆∞·ªùng/x√£\");\r\n    }\r\n  };\r\n\r\n  const handleUpdateQuantity = async (variantId: number, amount: number) => {\r\n    const currentItem = cartItems.find((item) => item.variantId === variantId);\r\n    if (!currentItem) return;\r\n\r\n    const newQuantity = currentItem.quantity + amount;\r\n    if (newQuantity < 1) return;\r\n\r\n    try {\r\n      await axios.post(\r\n        \"/api/cart/update\",\r\n        { accountId, variantId, quantity: newQuantity },\r\n        { headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` } }\r\n      );\r\n\r\n      setCartItems((prev) =>\r\n        prev.map((item) =>\r\n          item.variantId === variantId\r\n            ? { ...item, quantity: newQuantity, totalPrice: item.price * newQuantity }\r\n            : item\r\n        )\r\n      );\r\n      handleCalculateShippingFee();\r\n\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || \"L·ªói khi c·∫≠p nh·∫≠t gi·ªè h√†ng.\");\r\n    }\r\n  };\r\n\r\n  // üìå Gi·ªØ nguy√™n xo√° item\r\n  const handleRemoveItem = async (variantId: number) => {\r\n    try {\r\n      await axios.delete(\"/api/cart/remove\", {\r\n        params: { accountId, variantId },\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\r\n        },\r\n      });\r\n\r\n      setCartItems((prev) => prev.filter((item) => item.variantId !== variantId));\r\n      toast.success(\"ƒê√£ x√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè h√†ng!\");\r\n    } catch (error: any) {\r\n      setError(\"L·ªói khi x√≥a s·∫£n ph·∫©m.\");\r\n      toast.error(error.response?.data?.message || \"L·ªói khi x√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè h√†ng.\");\r\n    }\r\n  };\r\n\r\n  // üìå Gi·ªØ nguy√™n c·∫≠p nh·∫≠t bi·∫øn th·ªÉ\r\n  const handleUpdateVariant = (variantId: number, newVariant: { color: string; size: string; material: string }) => {\r\n    console.log(\"User selected new variant\", variantId, newVariant);\r\n  };\r\n\r\n  const defaultWeights = {\r\n    'tshirt': 200,\r\n    'jeans': 700,\r\n    'jacket': 600,\r\n    'dress': 350,\r\n    'accessory': 100,\r\n  };\r\n\r\n  function getWeight(item: CartItemType & { category?: keyof typeof defaultWeights }) {\r\n    return item.weightPerUnit\r\n      ?? (item.category ? defaultWeights[item.category] : undefined)\r\n      ?? 200; // fallback chung\r\n  }\r\n\r\n  const handleCalculateShippingFee = async () => {\r\n    const selectedCartItems = cartItems.filter(item =>\r\n      selectedItems.includes(item.variantId)\r\n    );\r\n\r\n    if (\r\n      selectedCartItems.length === 0 ||\r\n      !province ||\r\n      !district ||\r\n      !ward\r\n    ) {\r\n      setShippingFee(null);\r\n      return;\r\n    }\r\n    try {\r\n      setIsCalculatingFee(true);\r\n\r\n      const totalWeight = cartItems\r\n        .filter(item => selectedItems.includes(item.variantId))\r\n        .reduce((sum, item) => {\r\n          const weight = getWeight(item); // t·ª´ h√†m b√™n tr√™n\r\n          return sum + item.quantity * weight;\r\n        }, 0);\r\n\r\n      const totalWeightKg = (totalWeight / 1000).toFixed(2);  // Tr·ªçng l∆∞·ª£ng m·ªói s·∫£n ph·∫©m (1500 l√† gi√° tr·ªã m·∫∑c ƒë·ªãnh n·∫øu kh√¥ng c√≥)\r\n\r\n      // G·ªçi API t√≠nh ph√≠ v·∫≠n chuy·ªÉn v·ªõi tr·ªçng l∆∞·ª£ng ƒë√£ t√≠nh\r\n      const feeResponse = await axios.post(\"/api/locations/calculate-fee\", {\r\n        fromProvince: 217,\r\n        fromDistrict: 1566,\r\n        fromWard: 510103,\r\n        toProvince: parseInt(province),\r\n        toDistrict: parseInt(district),\r\n        toWard: parseInt(ward),\r\n        weight: totalWeight,  // Tr·ªçng l∆∞·ª£ng t·ªïng c·ªông\r\n      });\r\n\r\n      if (feeResponse.status !== 200) {\r\n        toast.error(\"L·ªói khi t√≠nh ph√≠ v·∫≠n chuy·ªÉn.\");\r\n        setShippingFee(null);\r\n        return;\r\n      }\r\n\r\n      const fee = feeResponse.data?.data?.total ?? 0;\r\n      setShippingFee(fee);\r\n\r\n      // G·ªçi API ∆∞·ªõc t√≠nh th·ªùi gian giao h√†ng\r\n      const timeResponse = await axios.post(\"/api/locations/estimate-delivery-time\", {\r\n        fromProvince: 217,\r\n        fromDistrict: 1566,\r\n        fromWard: 510103,\r\n        toProvince: parseInt(province),\r\n        toDistrict: parseInt(district),\r\n        toWard: parseInt(ward),\r\n        serviceId: 2,  // N·∫øu c√≥ serviceId ho·∫∑c th√™m tham s·ªë kh√°c c·∫ßn thi·∫øt\r\n      });\r\n\r\n      if (timeResponse.status !== 200) {\r\n        toast.error(\"L·ªói khi ∆∞·ªõc t√≠nh th·ªùi gian giao h√†ng.\");\r\n        return;\r\n      }\r\n\r\n      const estimatedDelivery = timeResponse.data?.data?.estimatedDelivery ?? \"Kh√¥ng c√≥ d·ªØ li·ªáu\";\r\n      setEstimatedDelivery(estimatedDelivery);  // L∆∞u th·ªùi gian giao h√†ng\r\n\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || \"Kh√¥ng th·ªÉ t√≠nh ph√≠ v·∫≠n chuy·ªÉn ho·∫∑c th·ªùi gian giao h√†ng.\");\r\n      setShippingFee(null);\r\n    } finally {\r\n      setIsCalculatingFee(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (province && district && ward) {\r\n      handleCalculateShippingFee();\r\n    }\r\n  }, [province, district, ward]);\r\n\r\n  const nextProduct = () => {\r\n    setCurrentIndex((prev) => (prev + 1) % productList.length);\r\n  };\r\n\r\n  const prevProduct = () => {\r\n    setCurrentIndex((prev) => (prev - 1 + productList.length) % productList.length);\r\n  };\r\n\r\n  const handleToggleSelectItem = (variantId: number) => {\r\n    setSelectedItems((prev) => {\r\n      const updatedItems = prev.includes(variantId)\r\n        ? prev.filter((id) => id !== variantId)\r\n        : [...prev, variantId];\r\n      handleCalculateShippingFee();\r\n      return updatedItems;\r\n    });\r\n  };\r\n\r\n\r\n  const handleToggleSelectAll = () => {\r\n    if (selectedItems.length === cartItems.length) {\r\n      setSelectedItems([]);\r\n      handleCalculateShippingFee();\r\n    } else {\r\n      setSelectedItems(cartItems.map((item) => item.variantId));\r\n      handleCalculateShippingFee();\r\n    }\r\n  };\r\n\r\n  const handleProceedToCheckout = () => {\r\n    if (selectedItems.length === 0) {\r\n      toast.error(\"Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt s·∫£n ph·∫©m.\");\r\n      return;\r\n    }\r\n\r\n    if (!shippingFee && !isCalculatingFee) {\r\n      toast.error(\"Vui l√≤ng ƒë·ª£i t√≠nh ph√≠ v·∫≠n chuy·ªÉn.\");\r\n      return;\r\n    }\r\n\r\n    const selectedCartItems = cartItems.filter(item =>\r\n      selectedItems.includes(item.variantId)\r\n    );\r\n\r\n    const checkoutData = {\r\n      items: selectedCartItems,\r\n      address: {\r\n        province: province || \"\",\r\n        district: district || \"\",\r\n        ward: ward || \"\",\r\n      }, pricing: { subtotal, discount, shippingFee, total, note, coupon, invoice, estimatedDelivery },\r\n    };\r\n\r\n    navigate(\"/checkout\", { state: checkoutData });\r\n  };\r\n\r\n  const subtotal = cartItems\r\n    .filter(item => selectedItems.includes(item.variantId))  // L·ªçc ch·ªâ c√°c s·∫£n ph·∫©m ƒë√£ ch·ªçn\r\n    .reduce((sum, item) => sum + item.totalPrice, 0);  // T√≠nh t·ªïng gi√° tr·ªã c√°c s·∫£n ph·∫©m ƒë√£ ch·ªçn\r\n\r\n  const discount = 0;\r\n  const total = subtotal - discount + (shippingFee || 0);  // T√≠nh t·ªïng sau khi √°p d·ª•ng ph√≠ v·∫≠n chuy·ªÉn\r\n\r\n  return (\r\n    <div>\r\n      <Navbar />\r\n      <div className=\"pt-20 flex flex-col lg:flex-row min-h-screen bg-gray-100 p-4 lg:p-6 gap-4\">\r\n        {/* Gi·ªè h√†ng */}\r\n        <div className=\"w-full lg:w-3/5 bg-white p-4 lg:p-6 rounded-lg shadow-md\">\r\n          <h2 className=\"pt-12 text-2xl font-bold flex items-center gap-3\">\r\n            Gi·ªè h√†ng\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={selectedItems.length === cartItems.length}\r\n              onChange={handleToggleSelectAll}\r\n              className=\"ml-2\"\r\n            />\r\n            <span className=\"text-sm font-medium\">Ch·ªçn t·∫•t c·∫£</span>\r\n          </h2>\r\n          {loading ? (\r\n            <Loading\r\n              text=\"ƒêang t·∫£i gi·ªè h√†ng...\"\r\n              color=\"yellow-500\"\r\n              size=\"6xl\"\r\n              icon={<FaCartPlus className=\"text-yellow-500 text-6xl animate-pulse\" />} // Icon ƒë·∫°i di·ªán ng∆∞·ªùi d√πng\r\n            />\r\n          ) : error ? (\r\n            <p className=\"text-center text-red-500\">{error}</p>\r\n          ) : cartItems.length === 0 ? (\r\n            <p className=\"text-center text-gray-500\">Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng.</p>\r\n          ) : (\r\n            cartItems.map((item) => (\r\n              <CartItem\r\n                key={item.variantId}\r\n                {...item}\r\n                selected={selectedItems.includes(item.variantId)}\r\n                toggleSelectItem={handleToggleSelectItem}\r\n                updateQuantity={handleUpdateQuantity}\r\n                removeItem={handleRemoveItem}\r\n                updateVariant={handleUpdateVariant}\r\n              />\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        {/* Th√¥ng tin ƒë∆°n h√†ng */}\r\n        <div className=\"w-full lg:w-2/5 bg-white p-4 lg:p-6 rounded-lg shadow-md\">\r\n          <div className=\"pt-12\">\r\n            {productList.length > 0 && (\r\n              <ProductSale\r\n                product={productList[currentIndex]}\r\n                onNext={nextProduct}\r\n                onPrev={prevProduct}\r\n                onCartUpdated={fetchCartItems}\r\n              />\r\n            )}\r\n          </div>\r\n\r\n          <h2 className=\"text-xl lg:text-2xl font-bold mb-4 mt-6\">Th√¥ng tin ƒë∆°n h√†ng</h2>\r\n          <div className=\"space-y-2 text-sm lg:text-base\">\r\n            <div className=\"flex justify-between\">\r\n              <span>T·∫°m t√≠nh:</span>\r\n              <span>{subtotal.toLocaleString()} vn‚Ç´</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span>Gi·∫£m gi√°:</span>\r\n              <span>{discount.toLocaleString()} vn‚Ç´</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span>Ph√≠ v·∫≠n chuy·ªÉn:</span>\r\n              <span>{shippingFee !== null ? `${shippingFee.toLocaleString()} vn‚Ç´` : \"ƒêang t√≠nh...\"}</span>\r\n            </div>\r\n            <div className=\"flex justify-between font-bold text-lg text-red-500\">\r\n              <span>T·ªïng c·ªông:</span>\r\n              <span>{total.toLocaleString()} vn‚Ç´</span>\r\n            </div>\r\n          </div>\r\n\r\n          <ShippingAddress\r\n            provinces={provinces}\r\n            districts={districts}\r\n            wards={wards}\r\n            province={province}\r\n            district={district}\r\n            ward={ward}\r\n            handleProvinceChange={handleProvinceChange}\r\n            handleDistrictChange={handleDistrictChange}\r\n            setWard={setWard}\r\n            estimatedDelivery={estimatedDelivery}\r\n          />\r\n\r\n          <DiscountAndNote\r\n            coupon={coupon}\r\n            setCoupon={setCoupon}\r\n            invoice={invoice}\r\n            setInvoice={setInvoice}\r\n            note={note}\r\n            setNote={setNote}\r\n          />\r\n          <button\r\n            onClick={handleProceedToCheckout}\r\n            disabled={\r\n              selectedItems.length === 0 || shippingFee === null || isCalculatingFee\r\n            }\r\n            className={`w-full text-white px-6 py-2 rounded-lg text-lg ${selectedItems.length === 0 || shippingFee === null || isCalculatingFee\r\n              ? \"bg-gray-400 cursor-not-allowed\"\r\n              : \"bg-blue-600 hover:bg-blue-700\"\r\n              }`}\r\n          >\r\n            Thanh to√°n\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <Footer />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CartPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}